# Default values for reth.

nameOverride: ""
fullnameOverride: ""

image:
  # -- Reth container image
  repository: ghcr.io/paradigmxyz/reth
  pullPolicy: IfNotPresent
  # -- Overrides the image tag (default: Chart.appVersion)
  tag: ""

imagePullSecrets: []

serviceAccount:
  create: true
  annotations: {}
  name: ""

rbac:
  create: true
  clusterRules:
    - apiGroups: [""]
      resources: ["nodes"]
      verbs: ["get", "list", "watch"]
  rules:
    - apiGroups: [""]
      resources: ["services"]
      verbs: ["get", "list", "watch"]

reth:
  # -- Ethereum network: mainnet, sepolia, holesky
  chain: "mainnet"

  # -- Run as full node (pruned) instead of archive
  fullNode: false

  # -- Additional CLI arguments passed to reth node
  extraArgs: []

  # -- Extra labels to attach to the Pod
  extraLabels: {}

  # -- Number of replicas (forced to 1 when p2pNodePort is enabled)
  replicaCount: 1

  # -- PersistentVolumeClaimSpec for chain data
  volumeClaimSpec:
    accessModes: ["ReadWriteOnce"]
    storageClassName:
    resources:
      requests:
        storage: 2Ti

  # -- Seconds to wait before force-killing the container
  terminationGracePeriodSeconds: 120

  podAnnotations: {}

  podSecurityContext:
    runAsNonRoot: true
    runAsUser: 10001
    runAsGroup: 10001
    fsGroup: 10001

  service:
    topologyAwareRouting:
      enabled: false
    type: ClusterIP
    ports:
      http-rpc: 8545
      http-ws: 8546
      http-authrpc: 8551
      http-metrics: 9001

  resources: {}
    # limits:
    #   cpu: 8
    #   memory: 16Gi
    # requests:
    #   cpu: 4
    #   memory: 8Gi

  nodeSelector: {}

  tolerations: []

  affinityPresets:
    antiAffinityByHostname: true

  affinity: {}

  p2pNodePort:
    enabled: false
    port: 31000
    initContainer:
      image:
        repository: bitnami/kubectl
        tag: "1.29"
        pullPolicy: IfNotPresent

  # -- Snapshot restore via streaming download (runs as init container)
  # Uses https://github.com/nodeify-eth/stream-download
  snapshotRestore:
    enabled: false
    image:
      repository: ghcr.io/nodeify-eth/stream-download
      tag: latest
      pullPolicy: IfNotPresent
    url: ""
    urls: ""
    subpath: ""
    tarArgs: ""
    compression: "auto"
    rmSubpath: "true"
    maxRetries: 10
    stallMinutes: 3
    checksumSha256: ""
    checksumsSha256: ""
    extraEnv: []

  initChownData:
    enabled: true
    image:
      repository: busybox
      tag: "1.36.1"
      pullPolicy: IfNotPresent

  # -- Startup probe configuration
  # Protects slow-starting nodes during initial sync.
  # Default window: failureThreshold(2880) x periodSeconds(30s) = 24 hours.
  startupProbe:
    enabled: true
    tcpSocket:
      port: http-rpc
    periodSeconds: 30
    timeoutSeconds: 5
    failureThreshold: 2880

  # -- Readiness probe configuration (active after startupProbe succeeds)
  readinessProbe:
    enabled: true
    tcpSocket:
      port: http-rpc
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 6

  # -- Liveness probe configuration (active after startupProbe succeeds)
  livenessProbe:
    enabled: true
    tcpSocket:
      port: http-rpc
    initialDelaySeconds: 30
    periodSeconds: 60
    timeoutSeconds: 5
    failureThreshold: 5

  # -- JWT secret for Engine API authentication (hex-encoded, 32 bytes)
  # If empty, a random secret is generated. Share this with your consensus client.
  jwtSecret: ""

# -- Reth HTTP RPC configuration
httpRpc:
  enabled: true
  addr: "0.0.0.0"
  # -- JSON-RPC API namespaces to enable
  api:
    - "eth"
    - "net"
    - "web3"
    - "txpool"

# -- Reth WebSocket RPC configuration
wsRpc:
  enabled: false
  addr: "0.0.0.0"
  api:
    - "eth"
    - "net"
    - "web3"

# -- Reth Engine API (Auth RPC) configuration
# Port is configured via reth.service.ports.http-authrpc
authRpc:
  addr: "0.0.0.0"

# -- Reth metrics configuration
# Port is configured via reth.service.ports.http-metrics
metrics:
  enabled: true
  addr: "0.0.0.0"

# -- Optional consensus client sidecar configuration (Lighthouse beacon node)
consensus:
  enabled: false
  client: lighthouse
  image:
    repository: sigp/lighthouse
    pullPolicy: IfNotPresent
    tag: latest

  # -- Optional checkpoint sync URL for faster sync bootstrap
  checkpointSyncUrl: ""

  # -- Additional CLI arguments passed to `lighthouse bn`
  extraArgs: []

  # -- Lighthouse P2P listener configuration
  p2p:
    port: 9000
    quicPort: 9001

  # -- Beacon API configuration
  beaconApi:
    enabled: true
    addr: "0.0.0.0"
    port: 5052

  # -- Lighthouse metrics configuration
  metrics:
    enabled: true
    addr: "0.0.0.0"
    port: 5054

  # -- Optional service to expose beacon API and/or consensus metrics
  service:
    enabled: true
    type: ClusterIP

prometheus:
  serviceMonitor:
    enabled: false
    interval: "30s"
    scrapeTimeout: "10s"
    labels: {}
